---
title: Node八股
date: 2023/10/5
type: tech
---

# Node

## 事件循环

1. **timer **阶段：执行 <u>setTimeout</u> 和 <u>setInterval</u> 注册的回调函数。
2. **pending callback **阶段：执行上一次事件循环中被延时的 I/O 回调函数。
3. **idle prepare** 阶段：仅用于 nodejs 内部模块的使用。
4. **poll **轮询阶段：轮询是否有 I/O 任务完成，如果有则执行相应的回调函数。否则，会在此阶段一直等待新的任务到达。当有  <u>setImmediate</u> 注册的回调函数时，那么将会进入 check 阶段。
5. **check **阶段：执行 <u>setImmediate</u> 注册的回调函数。
6. **close** 阶段：执行 <u>close</u> 事件的回调函数。

每个阶段完成后，需要执行 **nextTick** 队列和微任务队列中的任务，nextTick 的优先级<u>大于</u>微任务的优先级。

## 全局对象

### 真正的全局对象

- **global**：<u>全局命名空间对象</u>，有点类似于浏览器环境中的 window 对象。

  但也有区别，在 Node 环境中，如果我们在 js 文件中直接用 var 声明一个变量，是不会被添加到 global 对象中的。因为在 Node 里一个 js 文件只是一个独立的模块而已，所以我们在其中声明的变量并不会是一个全局的变量。

- **process**：提供当前<u>进程</u>的相关信息。

- **console**：<u>控制台</u>对象。

- **Buffer**：存储<u>二进制类型</u>数据。

- 定时器延时器函数

### 模块中的全局对象

这种全局对象实际上是<u>模块中的变量</u>，只是每个模块中都存在这些对象，所以看起来像全局的。但在 Node 命令行中去访问这些模块中的全局对象是访问不到的。

- **__dirname**：获取当前文件所在路径，<u>不包括</u>最后的文件名。
- **__filename**：获取当前文件所在路径，<u>包括</u>最后的文件名。
- exports：指定一个模块所导出的内容（属性）。
- module：通过 **module.exports** 来指定一个模块所导出的内容（对象）
